<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (current.Current_term.Make)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">current</a> &#x00BB; <a href="../index.html">Current_term</a> &#x00BB; Make</nav><h1>Module <code>Current_term.Make</code></h1></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-Input/index.html">Input</a> : <a href="../S/index.html#module-type-INPUT">S.INPUT</a></code></li></ul><h3 class="heading">Signature</h3><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../S/index.html#module-type-TERM">S.TERM</a> <span class="keyword">with</span> <span class="keyword">type</span> <span>'a <a href="../S/module-type-TERM/index.html#type-input">input</a></span> := <span><span class="type-var">'a</span> <a href="argument-1-Input/index.html#type-t">Input.t</a></span></code></span></summary><dl><dt class="spec type" id="type-input"><a href="#type-input" class="anchor"></a><code><span class="keyword">type</span> <span>'a input</span></code></dt><dd><p>See <code>INPUT</code>.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>+'a t</span></code></dt><dd><p>An <code>'a t</code> is a term that produces a value of type <code>'a</code>.</p></dd></dl><dl><dt class="spec type" id="type-description"><a href="#type-description" class="anchor"></a><code><span class="keyword">type</span> description</code></dt><dd><p>Information about operations hidden behind a bind.</p></dd></dl><dl><dt class="spec value" id="val-active"><a href="#val-active" class="anchor"></a><code><span class="keyword">val</span> active : <a href="../Output/index.html#type-active">Output.active</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>active x</code> is a term indicating that the result is not determined yet.</p></dd></dl><dl><dt class="spec value" id="val-return"><a href="#val-return" class="anchor"></a><code><span class="keyword">val</span> return : <span>?&#8288;label:string</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>return x</code> is a term that immediately succeeds with <code>x</code>.</p><dl><dt>parameter label</dt><dd><p>Label the constant in the diagrams.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-fail"><a href="#val-fail" class="anchor"></a><code><span class="keyword">val</span> fail : string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>fail m</code> is a term that immediately fails with message <code>m</code>.</p></dd></dl><dl><dt class="spec value" id="val-state"><a href="#val-state" class="anchor"></a><code><span class="keyword">val</span> state : <span>?&#8288;hidden:bool</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span>[ <span>`Active of <a href="../Output/index.html#type-active">Output.active</a></span> <span><span>| `Msg</span> of string</span> ]</span>)</span> Stdlib.result</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>state t</code> always immediately returns a successful result giving the current state of <code>t</code>.</p><dl><dt>parameter hidden</dt><dd><p>If <code>true</code>, don't show a separate node for this on the diagrams.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-catch"><a href="#val-catch" class="anchor"></a><code><span class="keyword">val</span> catch : <span>?&#8288;hidden:bool</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> <a href="../S/index.html#type-or_error">S.or_error</a></span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>catch t</code> successfully returns <code>Ok x</code> if <code>t</code> evaluates successfully to <code>x</code>, or successfully returns <code>Error e</code> if <code>t</code> fails with error <code>e</code>. If <code>t</code> is active then <code>catch t</code> will be active too.</p><dl><dt>parameter hidden</dt><dd><p>If <code>true</code>, don't show a separate node for this on the diagrams.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-ignore_value"><a href="#val-ignore_value" class="anchor"></a><code><span class="keyword">val</span> ignore_value : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>unit <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>ignore_value x</code> is <code>map ignore x</code>.</p></dd></dl><dl><dt class="spec value" id="val-of_output"><a href="#val-of_output" class="anchor"></a><code><span class="keyword">val</span> of_output : <span><span class="type-var">'a</span> <a href="../Output/index.html#type-t">Output.t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>of_output x</code> is a returned, failed or active term.</p></dd></dl><section><header><h2 id="sequencing-terms"><a href="#sequencing-terms" class="anchor"></a>Sequencing terms</h2></header><section><header><h3 id="applicative-operations"><a href="#applicative-operations" class="anchor"></a>Applicative operations</h3></header><dl><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val</span> map : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map f x</code> is a term that runs <code>x</code> and then transforms the result using <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-map_error"><a href="#val-map_error" class="anchor"></a><code><span class="keyword">val</span> map_error : <span>(string <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map_error f x</code> is a term that runs <code>x</code> and then transforms the error string (if any) using <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span class="keyword">val</span> pair : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>pair a b</code> is the pair containing the results of evaluating <code>a</code> and <code>b</code> (in parallel).</p></dd></dl><dl><dt class="spec value" id="val-list_map"><a href="#val-list_map" class="anchor"></a><code><span class="keyword">val</span> list_map : <span>pp:<span><span class="type-var">'a</span> Fmt.t</span></span> <span>&#45;&gt;</span> <span>(<span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'b</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>list_map ~pp f xs</code> adds <code>f</code> to the end of each input term and collects all the results into a single list.</p><dl><dt>parameter pp</dt><dd><p>Label the instances.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-list_iter"><a href="#val-list_iter" class="anchor"></a><code><span class="keyword">val</span> list_iter : <span>pp:<span><span class="type-var">'a</span> Fmt.t</span></span> <span>&#45;&gt;</span> <span>(<span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>unit <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>unit <a href="index.html#type-t">t</a></span></code></dt><dd><p>Like <code>list_map</code> but for the simpler case when the result is unit.</p></dd></dl><dl><dt class="spec value" id="val-list_seq"><a href="#val-list_seq" class="anchor"></a><code><span class="keyword">val</span> list_seq : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> list</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>list_seq x</code> evaluates to a list containing the results of evaluating each element in <code>x</code>, once all elements of <code>x</code> have successfully completed.</p></dd></dl><dl><dt class="spec value" id="val-option_map"><a href="#val-option_map" class="anchor"></a><code><span class="keyword">val</span> option_map : <span>(<span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> option</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'b</span> option</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>option_map f x</code> is a term that evaluates to <code>Some (f y)</code> if <code>x</code> evaluates to <code>Some y</code>, or to <code>None</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-option_seq"><a href="#val-option_seq" class="anchor"></a><code><span class="keyword">val</span> option_seq : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> option</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> option</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>option_seq None</code> is <code>Current.return None</code> and <code>option_seq (Some x)</code> is <code>Current.map some x</code>. This is useful for handling optional arguments that are currents.</p></dd></dl><dl><dt class="spec value" id="val-all"><a href="#val-all" class="anchor"></a><code><span class="keyword">val</span> all : <span><span>unit <a href="index.html#type-t">t</a></span> list</span> <span>&#45;&gt;</span> <span>unit <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>all xs</code> is a term that succeeds if every term in <code>xs</code> succeeds.</p></dd></dl><dl><dt class="spec value" id="val-all_labelled"><a href="#val-all_labelled" class="anchor"></a><code><span class="keyword">val</span> all_labelled : <span><span>(string * <span>unit <a href="index.html#type-t">t</a></span>)</span> list</span> <span>&#45;&gt;</span> <span>unit <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>all xs</code> is a term that succeeds if every term in <code>xs</code> succeeds. The labels are used if some terms fail, to indicate which ones are failing.</p></dd></dl><dl><dt class="spec value" id="val-gate"><a href="#val-gate" class="anchor"></a><code><span class="keyword">val</span> gate : <span>on:<span>unit <a href="index.html#type-t">t</a></span></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>gate ~on:ctrl x</code> is the same as <code>x</code>, once <code>ctrl</code> succeeds.</p></dd></dl></section><section><header><h3 id="monadic-operations"><a href="#monadic-operations" class="anchor"></a>Monadic operations</h3></header><aside><p><b>N.B.</b> these operations create terms that cannot be statically analysed until after they are executed.</p></aside><dl><dt class="spec value" id="val-bind"><a href="#val-bind" class="anchor"></a><code><span class="keyword">val</span> bind : <span>?&#8288;info:<a href="index.html#type-description">description</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>bind f x</code> is a term that first runs <code>x</code> to get <code>y</code> and then behaves as the term <code>f y</code>. Static analysis cannot look inside the <code>f</code> function until <code>x</code> is ready, so using <code>bind</code> makes static analysis less useful. You can use the <code>info</code> argument to provide some information here.</p></dd></dl><dl><dt class="spec value" id="val-bind_input"><a href="#val-bind_input" class="anchor"></a><code><span class="keyword">val</span> bind_input : <span>info:<a href="index.html#type-description">description</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-input">input</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>bind_input ~info f x</code> is a term that first runs <code>x</code> to get <code>y</code> and then behaves as the input <code>f y</code>. <code>info</code> is used to describe the operation in the analysis result.</p></dd></dl><dl><dt class="spec value" id="val-component"><a href="#val-component" class="anchor"></a><code><span class="keyword">val</span> component : <span><span>(<span class="type-var">'a</span>, Stdlib.Format.formatter, unit, <a href="index.html#type-description">description</a>)</span> Stdlib.format4</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>component name</code> is used to annotate binds, so that the system can show a name for the operations hidden inside the bind's function. <code>name</code> is used as the label for the bind in the generated dot diagrams. For convenience, <code>name</code> can also be a format string.</p></dd></dl><div class="spec module" id="module-Syntax"><a href="#module-Syntax" class="anchor"></a><code><span class="keyword">module</span> <a href="Syntax/index.html">Syntax</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section></section></details></div></div></div><dl><dt class="spec value" id="val-env"><a href="#val-env" class="anchor"></a><code><span class="keyword">val</span> env : <span><a href="argument-1-Input/index.html#type-env">Input.env</a> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>env</code> evaluates to the user-provided environment.</p></dd></dl><div class="spec module" id="module-Analysis"><a href="#module-Analysis" class="anchor"></a><code><span class="keyword">module</span> <a href="Analysis/index.html">Analysis</a> : <a href="../S/index.html#module-type-ANALYSIS">S.ANALYSIS</a> <span class="keyword">with</span> <span class="keyword">type</span> <span>'a <a href="../S/module-type-ANALYSIS/index.html#type-term">term</a></span> := <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../S/module-type-ANALYSIS/index.html#type-job_id">job_id</a> := <a href="argument-1-Input/index.html#type-job_id">Input.job_id</a></code></div><div class="spec module" id="module-Executor"><a href="#module-Executor" class="anchor"></a><code><span class="keyword">module</span> <a href="Executor/index.html">Executor</a> : <a href="../S/index.html#module-type-EXECUTOR">S.EXECUTOR</a> <span class="keyword">with</span> <span class="keyword">type</span> <span>'a <a href="../S/module-type-EXECUTOR/index.html#type-term">term</a></span> := <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../S/module-type-EXECUTOR/index.html#type-env">env</a> := <a href="argument-1-Input/index.html#type-env">Input.env</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../S/module-type-EXECUTOR/index.html#type-analysis">analysis</a> := <a href="Analysis/index.html#type-t">Analysis.t</a></code></div></div></body></html>